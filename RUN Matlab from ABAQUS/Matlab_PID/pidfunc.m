% function controlsignal = pidfunc(plantoutputp, plantoutputc, currenttime, dt, lastcontrolinput)
function controlsignal = pidfunc(T)

plantoutputp = T(1);
plantoutputc = T(2);
currenttime = T(3);
dt = T(4);
lastcontrolinput = T(5);

%% PID
% Kp = 70;
% Ki = 0;
% Kd = 0;
% Tf = 100; 
% 
% C = -(Kp + Ki*tf(1,[1 0]) + Kd*tf([1 0],[Tf 1]));

%% Model 1
AA = [-950680614.437965,58540475.7253688,374834779.553036,701399445.270722,41710414.7917130,-713846632.528637,-836052492.053132,-711917649.144977,529777655.708808,245005545.385186,-41860465.0793182,-506940847.533061,385546654.984568,109115092.788548,243065467.817187,1059252844.94460,178042007.602502,768438717.184271,-215451784.630449,-318758532.808401,-1326548557.79523,-536435136.130221,103187477.692565,-1200852911.11495,-399746481.663582,1288944683.47052,-324902236.648494,-129283669.737619,752436137.758764,-1032636344.01845,-696188756.293235,-12766223871.8385;-65479951534.0150,4029636713.08140,25817450708.2730,48310079801.1573,2872872523.67570,-49167435212.8368,-57584581711.6186,-49034667753.6525,36489364790.3180,16875218531.5229,-2883223318.45926,-34916504387.7635,26555200092.5522,7515508663.45718,16741591151.7391,72957898773.3888,12262978278.4983,52927611344.7533,-14839647526.8840,-21955056774.0749,-91368527766.6919,-36947893450.6785,7107306280.07758,-82711004764.7892,-27533290021.1097,88778520539.2626,-22378025005.3064,-8904656355.23021,51825559802.3380,-71124770132.5301,-47951310280.0413,-879297276290.435;41553115021.5283,-2557180377.82633,-16383580879.5233,-30657279516.3739,-1823105667.34285,31201324735.6611,36542789424.4324,31117070915.4660,-23155906214.1234,-10708900370.7612,1829674136.42209,22157779240.2811,-16851751919.7626,-4769291328.17661,-10624101343.4695,-46298593325.1839,-7782003619.33417,-33587506987.7103,9417140678.71717,13932531785.1021,57981854226.4037,23446885519.9020,-4510248424.09128,52487848186.9423,17472441052.9897,-56338252747.3109,14200945634.0079,5650835148.04288,-32888151621.2470,45135301677.9172,30429579618.0917,557996148596.566;-26806929762.2762,1649699508.19426,10569474943.5948,19777742051.5437,1176130002.69766,-20128736180.2343,-23574645463.9304,-20074381319.1126,14938440333.7484,6908572778.44637,-1180367343.99023,-14294523794.3694,10871476511.5918,3076786153.24017,6853866767.47718,29868352711.9007,5020361183.19444,21668120811.7351,-6075227110.93209,-8988216368.36341,-37405508336.3914,-15126158127.1430,2909671683.01805,-33861192054.6715,-11271896782.7062,36345182798.0146,-9161375965.89234,-3645491318.25189,21216950180.1626,-29117882238.9610,-19630862743.0160,-359976940794.980;-15074254077.3391,927670211.907891,5943483678.42828,11121553896.8292,661369365.951552,-11318948604.9881,-13256654435.2392,-11288362500.7042,8400285011.57759,3884875615.64128,-663752221.199940,-8038193777.87335,6113322351.37906,1730159303.80963,3854112999.39954,16795774523.1195,2823083241.24909,12184564517.1999,-3416263009.30295,-5054314739.56025,-21034119664.6300,-8505843761.55619,1636186249.19381,-19041055192.5139,-6338490093.82858,20437869400.1448,-5151687136.23009,-2049957570.32207,11930859095.8380,-16373766203.0817,-11038960711.2678,-202424672293.688;-1777165683.42316,109366850.772865,700701656.240000,1311165656.01395,77992805.1258523,-1334434817.41036,-1562881413.33244,-1330833013.89664,990344090.013730,458004327.022812,-78252621.6412426,-947656394.873065,720724668.259659,203975745.803897,454377674.345428,1980122815.64126,332824256.744897,1436488331.63277,-402757597.658778,-595873910.307741,-2479800564.02025,-1002788840.26208,192896713.198257,-2244828805.97679,-747272287.141786,2409504332.59118,-607353560.642052,-241678359.875379,1406577946.79052,-1930373708.71788,-1301430636.08416,-23864675641.8909;-7039192132.29066,433192171.267824,2775415828.61125,5193408207.68184,308838259.804556,-5285575241.37758,-6190431490.19142,-5271329434.30705,3922663084.11763,1814112520.91646,-309951131.368214,-3753579000.90065,2854725028.48053,807928976.399219,1799747443.39025,7843086821.63468,1318288413.53154,5689799979.47536,-1595285403.09473,-2360202512.98792,-9822259969.06897,-3971955617.71244,764046410.172008,-8891561510.77356,-2959873096.15468,9543828115.63024,-2405672256.42288,-957264818.443528,5571327736.66295,-7646026270.37842,-5154842461.55901,-94525815556.6307;1279673171.81421,-78751140.2656137,-504550113.546880,-944123302.223681,-56144579.8787562,960879132.032532,1125400476.22442,958283895.768656,-713110400.847167,-329792190.035998,56346853.9084786,682372803.584380,-518967376.227367,-146875505.930990,-327180704.390532,-1425813825.11744,-239655217.840695,-1034363073.22089,290011050.743752,429066991.725215,1785613988.86436,722071275.470467,-138898804.053566,1616420123.19449,538082745.860181,-1734997813.30092,437330984.675139,174023594.933788,-1012827387.71755,1389990503.66149,937111870.473745,17184090883.7979;1605453537.15319,-98799675.9942291,-632998942.370516,-1184479043.84392,-70437832.2502988,1205499905.56395,1411873682.58980,1202244634.11844,-894655693.304593,-413768357.961234,70691803.3209047,856092787.410802,-651087268.110337,-184267315.451045,-410475006.425818,-1788800650.43049,-300666423.695243,-1297692870.06654,363842555.171556,538299761.792947,2240198545.73544,905898016.910468,-174258766.704512,2027930277.29283,675069544.885289,-2176694732.82181,548670236.723977,218326993.595587,-1270672463.42737,1743857842.10073,1175684263.91150,21558838118.2364;-2371093639.66723,145917199.474907,934875866.648338,1749356591.37553,104029604.347205,-1780402301.45982,-2085195661.96116,-1775594655.99636,1321333713.46284,611068644.375235,-104404460.048401,-1264361760.59808,961590285.669199,272144137.232315,606229861.892931,2641878371.33990,444054779.765414,1916561851.15033,-537358571.938143,-795014544.503024,-3308546332.74684,-1337920044.47242,257363019.351725,-2995048713.09172,-997008138.636568,3214759682.04351,-810329862.582563,-322446569.870046,1876656100.26979,-2575499501.87581,-1736365202.64192,-31840237415.5509;1276476458.95001,-78554413.4763549,-503289712.130533,-941764791.405482,-56004259.6703690,958478222.841126,1122563491.30593,955890032.125603,-711329874.276743,-328968317.746235,56206046.6452306,680686565.470091,-517671422.375984,-146508594.903287,-326363408.969167,-1422253298.32555,-239056519.390020,-1031779646.96384,289286594.955615,427995498.716334,1781153495.02420,720268294.044848,-138551135.504161,1612382226.03995,536738660.492719,-1730663405.62793,436240617.687945,173588888.484895,-1010296310.83844,1386518363.59831,934771002.209003,17141167833.0342;-363095795.942866,22344930.0317914,143161573.710250,267886519.581338,15930501.6955648,-272640676.124285,-319314981.283879,-271904468.216449,202338539.651150,93575578.9367953,-16006236.5414759,-193617170.967169,147252988.002264,41674589.9859594,92834596.7151277,404563337.811679,68000020.7543390,293491804.336733,-82288032.5809239,-121744310.865018,-506651973.443498,-204882175.759536,39410491.9957548,-458644717.570015,-152676169.672029,492289761.907007,-124091190.248964,-49377632.2644814,287379571.900118,-394397363.432373,-265897100.087220,-4875836266.29164;-265393377.994353,16332319.4493384,104639420.434353,195803171.674741,11643895.9519643,-199278076.162970,-233393192.838935,-198739966.118086,147893221.342091,68396123.6168623,-11685867.5207687,-141518435.719287,107629556.941120,30449211.3783658,67854247.2338138,295702022.063672,49702812.8043446,214518270.036114,-60145656.9718205,-88984949.1894920,-370320223.299363,-149751664.344494,28806278.5486913,-335231514.547183,-111592888.224263,359823815.851842,-90699230.6335660,-36090774.0210691,210051621.880782,-288270510.894977,-194347837.523728,-3563836103.66711;883660147.592156,-54380481.4189499,-348409920.478344,-651950929.837500,-38769795.0436275,663521054.768109,777111561.199109,661729342.297733,-492428802.657212,-227733311.765950,38909479.6264621,471202860.583465,-358354510.827364,-101422783.493883,-225929986.830462,-984576746.746647,-165490523.362945,-714265216.448414,200263005.068151,296286464.804244,1233030369.33854,498616867.082729,-95913909.6349557,1116195959.02329,371565382.438575,-1198077843.64341,301994808.797072,120169512.429605,-699392612.645677,959838167.052733,647109263.908457,11866233954.9700;-95369036.7121018,5869014.42944318,37602146.6839995,70361815.3802319,4184230.87549529,-71610521.3512833,-83869778.9840307,-71417150.7166045,53145388.7830823,24578121.4758170,-4199306.65548408,-50854576.3768828,38676655.5841466,10946056.2173788,24383497.3312567,106229030.079228,17860544.7742336,77086395.3726350,-21613395.8027140,-31976415.5493380,-133074824.040573,-53812743.8962534,10351915.5545981,-120465472.001394,-40101197.4426895,129302726.668612,-32591621.1027865,-12969298.8551787,75482498.0322865,-103590548.941657,-69839279.8767344,-1280661359.49496;126351072.759861,-7775650.15951038,-49817757.8048333,-93219887.3076758,-5543539.82835929,94874253.7530883,111116111.555887,94618063.7621898,-70410450.2589851,-32562685.5651348,5563512.29655735,67375431.1733002,-51241330.6249797,-14502039.5003816,-32274092.8900747,-140780703.569085,-23660358.6630795,-102129939.893689,28635571.1973315,42364814.6387649,176309072.263802,71295228.6256939,-13714374.3212531,159601409.317883,53131077.6449573,-171308435.965833,43180989.4790769,17183197.6024509,-100003405.283403,137247995.272739,92530758.0335109,1696705796.38417;62183867.9028272,-3826797.77659236,-24517883.4127834,-45878305.8349305,-2728261.31317452,46692504.7628947,54685959.2063132,46566420.4390540,-34652607.7867819,-16025774.3973047,2738090.62168969,33158920.2699128,-25218500.1752312,-7137201.21537871,-15898852.0763841,-69287040.9172338,-11645695.8986331,-50239414.8373892,14092671.4796054,20849336.5912924,86769344.9057031,35087398.3445843,-6750071.80793414,78547605.4994147,26147365.7397289,-84309890.2814568,21250103.0311350,8456432.25632262,-49217505.2923975,67544605.9697161,45537617.8074386,835033554.078415;26769243.4686319,-1647380.28972438,-10554589.3465575,-19749938.0460053,-1174476.55938533,20100438.7287330,23541503.5496307,20046161.3268709,-14917439.5602926,-6898860.82064273,1178708.38639607,14274428.0315326,-10856193.3443200,-3072460.59955747,-6843805.64137804,-29826366.7591451,-5036956.15663032,-21637655.1609386,6067145.02166585,8975562.45255759,37354134.4142175,15104884.9209658,-2905581.70014779,33813968.3238783,11256996.6102538,-36294082.2673771,9148501.90316501,3640612.07052185,-21187112.5409595,29078704.2554473,19604488.9095451,359470799.252688;24653405.1932597,-1517171.63728369,-9720355.68898515,-18188904.9681935,-1081645.97052988,18511702.1458430,21680785.9608506,18461714.7439704,-13738366.7735876,-6353575.50490215,1085542.67992018,13146179.8031830,-9998122.05055816,-2829613.63882373,-6303258.64645664,-27469184.7452275,-4617056.80259914,-19927705.9396173,5587178.10694570,8256814.70805128,34400566.5821071,13910605.3386683,-2676228.62986877,31140979.7354581,10366376.9510858,-33425527.1985547,8424591.96062965,3352635.51455812,-19512872.6514573,26778718.5680150,18053833.0104338,331056983.016545;-65306550.2010197,4018967.62539904,25749095.9878937,48182173.0167088,2865266.26502966,-49037258.4591012,-57432119.0521295,-48904842.7481181,36392754.5438879,16830539.6318079,-2875589.81212735,-34824058.5394098,26484891.9600289,7495609.72279343,16697150.8694368,72764732.0087857,12230833.1856028,52787485.8096710,-14791147.7853498,-21896925.1950499,-91127624.6207211,-36850067.1837797,7088480.15380220,-82492294.3774013,-27461097.6247174,88543446.2581881,-22318789.3042061,-8881260.89983770,51688320.2566330,-70937739.6058333,-47825241.0430575,-876969028.546110;-15677398.8117378,964787.775966089,6181291.85460624,11566544.8540947,687831.792103468,-11771815.4804127,-13787074.0826511,-11740027.9194991,8736393.48328368,4040315.68350283,-690310.008577011,-8359814.80991376,6357924.30010758,1799385.90633225,4008322.46789414,17467473.6217507,2936039.85918371,12671880.7049225,-3552956.23576932,-5256257.14898602,-21875729.6029514,-8878882.43725380,1698594.30274110,-19802916.7515259,-6592105.02610946,21254928.2660752,-5362495.54572642,-2131967.04848713,12406118.8501252,-17028895.2373481,-11480629.4537814,-210532267.670390;11558840.5282723,-711331.558385885,-4557424.84172004,-8527935.60292050,-507133.753912244,8679280.25730230,10165116.9830621,8655843.49735402,-6441284.28093152,-2978897.49987522,508961.024802060,6163635.22248902,-4687655.91856420,-1326675.45316073,-2955357.95395457,-12878892.4148288,-2164623.57816562,-9343042.59499857,2619671.15412527,3875618.28132568,16159869.2200961,6522229.10304335,-1254617.24228557,14599285.5500219,4858373.27553439,-15671619.8995056,3950282.59334298,1571463.50560157,-9148514.41741489,12552266.4593379,8462577.93593433,155217997.305172;32545248.1080904,-2002835.93819520,-12831955.0603658,-24011385.8584375,-1427893.53042853,24437514.1649154,28621058.4803917,24371525.2866734,-18136178.3300678,-8387429.34439882,1433038.19320586,17354425.1686251,-13198635.9344109,-3735406.69140840,-8321036.46557664,-36262003.8814625,-6094982.46514094,-26306421.9603300,7375739.88344157,10912245.4452817,45414198.8969166,18364081.6623691,-3532519.78410337,41089636.0570199,13682613.5358846,-44125262.9534080,11122471.7237531,4425456.68246099,-25758681.7846465,35348169.9227089,23831322.1412818,437034043.131302;-29824552.9217393,1835404.11344004,11759238.1369181,22004098.5874431,1308525.51101992,-22394603.6737193,-26228414.4854539,-22334131.3673812,16620042.4039996,7686263.06071504,-1313240.32991116,-15903641.7491878,12095265.2833323,3423136.45414761,7625400.04656705,33230541.9089969,5585490.25773265,24107234.3321879,-6759108.53174659,-9999966.84409561,-41616202.0974167,-16828194.7466125,3256626.03023004,-37672895.1914912,-12540764.6479906,40436175.4594276,-10194415.4644492,-4055855.70043963,23604520.8920058,-32395651.8516640,-21840687.3055709,-400501853.470506;1088544.46733981,-66989.0900268649,-429191.802353131,-803111.445890741,-47758.9122980137,817364.214435634,957291.745602980,815157.056296543,-606602.791505295,-280535.215748909,47930.9655720678,580455.385876394,-441456.569072101,-124938.656870642,-278313.382126276,-1212916.38821000,-203864.272600126,-879908.473455710,246693.974480472,365025.304295906,1518920.57593752,614656.687656187,-117294.505738906,1374993.28832453,457713.272746453,-1501460.58011650,366383.517857219,148042.494389006,-863976.406664020,1182389.50316550,797160.033750592,14610087.0471175;4655062.26320386,-286472.749632184,-1835400.04372979,-3434433.68014171,-204236.662874001,3495384.33428623,4093771.57769065,3485945.68799574,-2594081.90911406,-1199683.75105057,204972.383906169,2482265.03402963,-1887847.69339968,-534288.394477936,-1190186.83698936,-5186683.02312534,-871788.307292638,-3762702.70060574,1054977.60800552,1560816.45360313,6495664.26374884,2626673.79410971,-505278.807700431,5880177.67752684,1982472.97076882,-6311397.18674571,1590910.10991706,632863.396927508,-3684346.92788730,5055137.04411098,3408252.81993668,62510596.3618317;-1258330.35250121,77437.6047585760,496135.055713838,928376.864765675,55208.1486548539,-944852.672389494,-1106604.99982434,-942301.344641830,701217.556887245,324291.991135364,-55407.3073970334,-670991.852117626,510312.500230049,144425.803011436,321717.442036327,1402034.71318567,235666.577150634,1017106.74533032,-285159.047243077,-421911.709637537,-1755540.00564016,-710032.520298550,136569.846717144,-1589240.06942343,-527459.961548235,1706031.35502712,-430063.068288968,-187071.737458770,995926.829076396,-1394689.06354813,-926867.197478079,-16897382.2494428;-8446261.09559595,519783.268784740,3330195.62453404,6231522.14271108,370572.111455461,-6342112.51169864,-7427841.15384863,-6324986.82600499,4706766.91493816,2176736.14637231,-371907.188808592,-4503883.49705091,3425357.94944817,969426.166281648,2159499.20280914,9410842.99601489,1581803.48922680,6827137.08452208,-1914168.11667072,-2831981.30784197,-11785637.1627486,-4765884.88254305,916819.149307946,-10668904.8776454,-3551521.22198887,11451601.2186860,-2871653.64139636,-1148609.39427299,6679493.69734886,-9174329.71842265,-6185226.24362054,-113422674.167353;38336175.4701976,-2359209.72716107,-15115204.5051273,-28283843.4093288,-1681965.29671393,28785794.6673935,33713736.0436314,28708064.1573896,-21363232.6855183,-9879843.91857399,1688025.53480418,20442378.6192205,-15547130.6557407,-4400064.52291820,-9801613.22884959,-42714269.6321488,-7179528.11712619,-30987240.4335547,8688094.57929343,12853909.3982036,53493153.0762446,21631687.1204316,-4161067.99337889,48424439.8218720,16120383.8986545,-51976673.4720233,13101530.7072793,5218373.14380842,-30342020.9474349,41617123.3427143,28071345.5508257,514797334.199831;5240873.02802708,-322523.571007481,-2066373.77386847,-3866635.89610365,-229938.594641167,3935256.80619221,4608947.40032091,3924630.37753439,-2920531.12982616,-1350656.49152782,230767.029112553,2794642.64938626,-2125421.71380040,-601525.471126781,-1339961.19999021,-5839418.52637771,-981506.762928719,-4236227.88719492,1187732.62679049,1757253.49878324,7312942.19829555,2957377.65076976,-568620.648166321,6620012.25069697,2203703.67553492,-7105384.13627448,1811356.67215110,712672.289770130,-4127551.66536120,5692689.39587924,3837956.08889064,70362750.6412736;796889.835574841,-49040.6336849486,-314198.082440921,-587933.122123808,-34962.8269883462,598367.128247008,700803.709021449,596751.351572028,-444075.160363637,-205371.218116149,35088.8067647041,424933.462411736,-323176.483727782,-91463.6927343183,-203745.065120230,-887897.081064061,-149240.735099431,-644128.519380497,180598.132855304,267193.370017179,1111954.15510681,449657.343885404,-86493.0868263717,1006591.35233432,335079.810573937,-1080432.07941306,272386.389082661,108371.371065418,-630687.530007877,865592.910342480,583582.717302664,10664225.8683518;-1123161.06441041,69119.3785565333,442840.449539919,828651.040094418,49277.6831665187,-843357.049109103,-987734.317588222,-841079.723833634,625893.194851069,289456.514747557,-49455.2302974750,-598914.299155648,455494.879724113,128911.695650024,287164.322159736,1251429.13682797,210344.258489070,907854.365168910,-254540.792816796,-376589.928515024,-1567218.60991164,-633758.430465874,121909.743565702,-1418719.74529182,-472257.728361902,1522796.91864996,-383842.313658611,-152725.349652384,888953.174290449,-1219863.00804982,-795681.347148879,-15082418.6641340];
BB = [-2.69436028892035;-2.74470162564953;2.76680667329020;1.66588747888564;-0.482134719359372;-2.36058128355884;-1.17462545753214;0.199817837106820;2.89363293695227;2.11758290007032;-0.278799517816313;-1.69445424247021;3.54146032522109;1.11395322769912;0.448550486096177;0.245687267543798;-0.351441920397298;1.14127705589721;-1.77654736643409;-2.98188897917400;0.300312707995365;-0.878509703532378;-0.900355052073194;-2.04223429665948;-0.427867824529744;-0.635423869321806;-2.19053534797604;0.370584776906107;1.69617308647403;-0.677701279716403;-0.0109819928198477;0.0187552912639743];
CC = [300422.342907429,-18488.0032386780,-118450.656480789,-221647.005756378,-13180.7604999542,225580.558824539,264198.489639282,224971.421386719,-167413.477337837,-77423.6284999847,13228.2501373291,160197.182550430,-121835.455734491,-34481.2098073959,-76810.5451202393,-334731.382779956,-56262.6354370117,-242832.275024414,68084.4135417938,100729.963951111,419199.486831665,169517.210205078,-32608.3743286133,379478.706298828,126322.940429688,-407316.513671875,102670.544921875,40854.6298828125,-237776.054687500,326320.976562500,220000.969726563,4034222.45312500];
DD = 0;
C = tf(ss(AA,BB,CC,DD));

%% Model 2
% AA = [-55416314.3895297,-15475080.9082547,35825257.1984020,-7702484.90679635,90932924.7216295,52704800.2666694,-1227490.94207122,30961560.6901671;143915131.751155,40137770.3968626,-93021265.2021877,20000704.0492691,-236110823.102265,-136856637.564537,3186448.04570657,-80392898.3464712;-16329044.5952328,-4554659.53793181,10555668.6364101,-2260252.68220085,26792889.1567166,15528085.5963710,-361613.172732092,9122654.74976474;-36867966.2403996,-10283633.7605497,23823752.7286646,-5124384.86323583,60494302.6982223,35064043.4806721,-816445.196962197,20597569.3116371;-2426522.36146043,-676828.506903966,1568592.32139600,-337314.075332048,3981458.94204157,2286899.12212109,-53852.5693479661,1355619.05183326;-4507443.42347373,-1257269.98222194,2913874.44241224,-626498.602198890,7412284.91925076,4286910.43012585,-99453.3945731361,2516459.31543021;2380844.15556579,664089.753885608,-1539066.56972446,330920.727821649,-3906524.53652486,-2264394.50333648,52720.4914366440,-1341664.45950531;1467522.56066611,409342.103198174,-948662.723571907,203974.108963441,-2407917.51996188,-1395481.20656299,44008.8384390365,-819873.781758535];
% BB = [9.05351269637724;1.03505623454704;-6.62071441167086;2.32088395968538;-2.06764294923605;0.377293511743987;3.12783300672205;-5.68508692161979];
% CC = [1250.69030394839,348.856800200054,-808.492813309151,173.836970403980,-2052.15348290838,-1189.49485238548,27.6947800146882,-698.733623779437];
% AA = [-1614935656.23270,480339381.915633,400620433.930060,2374835218.37262,860719631.998261,689396699.073176,825164041.996904,1308223884.80708,674565204.570826,3553496614.13083,1061792739.80725,-418207037.670609,-1261143338.53628,-1212792024.14442,-11051895.3113448,-3768083813.67898,-3464895703.56594,719912073.456973,19074494207.2164,2005300389.45673,-4562397287.09237,14804192463.5363,-11235177358.1596,38939420969.0631,159982956448.926,-95077929887.6942,-225374755628.481,-354103612581.094,-30208009596.3497,50056470247.6035,135243285203.370,-345376185731.213;-4501451247.08467,1338838485.67504,1116679994.00830,6619557675.13240,2399149825.92059,1921607548.65159,2300043012.57429,3646511353.60541,1880265237.27938,9904933442.14671,2959616209.30141,-1165700979.96696,-3515281385.46812,-3380506173.08406,-30805822.9411788,-10503064045.9527,-9657966104.57357,2006666115.92496,53167799409.0839,5589526767.16390,-12717120429.3675,41264863383.4548,-31316672534.0946,108538842788.776,445932782604.854,-265018010476.785,-628204352140.225,-987020174654.432,-84201103255.1332,139526240478.098,376973987924.037,-962693545123.535;964019271.652253,-286723295.612466,-239146261.644441,-1417659797.22984,-513797760.074364,-411528292.111649,-492573207.441697,-780930801.094814,-402674727.625574,-2121223323.28831,-633826275.527313,249644406.468089,752826570.177578,723963700.241395,6597317.58904007,2249318833.60065,2068333837.38936,-429744122.004940,-11386323445.5489,-1197043481.90042,2723476221.85038,-8837210744.30649,6706723782.03040,-23244487731.0577,-95500183667.9696,56755794164.3543,134535146646.076,211378516227.210,18032361207.4430,-29880696010.4658,-80732090675.7680,206168768301.096;-375479328.096728,111676864.888595,93172329.8143551,552158753.818111,200120296.986877,160287513.942481,191853580.156925,304167321.726906,156839034.864541,826200880.941486,246870305.974498,-97234908.9334331,-293219955.512300,-281978976.687855,-2569428.40619546,-876094600.387008,-805602244.431632,167382192.257496,4434898425.80699,466236475.921965,-1060777665.86862,3442035961.03287,-2612226895.23358,9053576568.41251,37196698320.4820,-22106008786.1717,-52400555425.4139,-82330550925.2912,-7023485970.05880,11638335899.9642,31444619831.1070,-80301387957.4624;-734636739.615051,218499247.672659,182242869.602360,1080315913.26357,391542711.935195,313598223.020115,375368428.807129,595112407.842548,306859993.571929,1616491156.22652,483011180.031433,-190243179.049540,-573696075.093186,-551700242.962182,-5027547.34076622,-1714105399.25104,-1576185203.26557,327489132.721099,8677016449.57521,912214277.463625,-2075441656.18670,6734450832.05803,-5110899747.43592,17713605641.2278,72776500372.0141,-43251098903.1216,-102523328566.337,-161082286361.516,-13741670748.0513,22770766279.8967,61522381790.9543,-157112165239.845;921293976.572270,-274015752.175937,-228547284.469390,-1354803519.65283,-491017126.140495,-393289219.462194,-470742610.992113,-746319719.507996,-384827833.266106,-2027211410.61787,-605735418.327738,238580243.523628,719461681.336290,691877303.399025,6304996.85950726,2149628253.65813,1976664768.52284,-410697994.729089,-10881681769.5093,-1143991906.27722,2602771414.08909,-8445546259.83125,6409481535.31433,-22214294230.1061,-91267621866.7229,54240380858.6998,128572557196.816,202010230512.808,17233168115.7864,-28556384865.0353,-77154049004.0468,197031377863.051;350204047.131560,-104159394.108115,-86875844.7641048,-514990485.264721,-186649853.951642,-149497775.751502,-178939500.297782,-283711178.356416,-146281959.973722,-770587253.675017,-230253191.523371,90689509.3264613,273483016.221333,262998113.115892,2396630.52439362,817121760.372334,751374257.884977,-156115265.251379,-4136366240.10108,-434855850.320383,989370686.407803,-3210337051.54762,2436384715.92630,-8444139247.83868,-34692822624.9441,20617957826.0818,48873247581.0577,76788518437.9764,6550704976.37035,-10854908207.7889,-29327945568.5094,74895947880.4604;-310973634.024383,92491294.4452816,77143892.2924334,457300460.002015,165741202.674260,132750866.245623,158912848.750997,251912797.914521,129894809.272311,684263593.311247,204459324.004766,-80530405.4916609,-242846363.866433,-233536298.760710,-2128052.10400367,-725585628.021429,-667203535.427605,138626789.162048,3673003639.13824,386140136.408126,-878540710.653022,2850710313.82772,-2163458158.32576,7498214552.46134,30806479832.7231,-18308300511.3275,-43398386593.3493,-68186547924.6812,-5816884175.62253,9638924285.88124,26042581877.0746,-66505985630.2869;-180448077.093940,53669746.1225269,44764130.2835982,265356866.751883,96174260.8079222,77031093.7058276,92201446.8220772,146176960.408063,75373823.9128698,397030061.133837,118640651.240324,-46729230.7470789,-140915345.855983,-135513682.224955,-1234731.19240642,-421034245.085602,-387156959.120490,80440526.6240686,2131326881.35607,224062619.688977,-509789930.793713,1654176259.75905,-1255386716.57267,4350974702.84392,17876017608.0962,-10623721674.9334,-25182696816.9633,-39566478982.2898,-3375351885.56917,5593160385.47241,15111678579.5800,-38591302320.2820;86836145.6159803,-25827230.2712663,-21541625.6608225,-127696358.893849,-46281457.3264925,-37069244.4939701,-44369617.7104443,-70343781.0163784,-36246263.8356692,-191073843.870417,-57093291.8462998,22486942.4085725,67812509.3461908,65214237.8654692,594217.083918499,202616232.784707,186312179.099248,-38710132.9305924,-1025649438.96098,-107826369.245260,245323037.280612,-796029954.029878,604122724.626920,-2093793603.99484,-8602380454.81392,5112401926.90057,12118546728.2354,19040381529.1720,1624304319.73452,-2691569365.74549,-7272119142.34658,18571104112.2018;-36143586.2739071,10750001.5304974,8966213.33019933,53150742.9484490,19263612.1958596,15429262.9409961,18467849.1716261,29279128.1074309,15097418.4553498,79530173.6400958,23763796.4412509,-9382771.21725056,-28225450.5086002,-27140155.4359130,-247444.958033957,-84326808.2012408,-77545864.6215752,16112231.1688798,426902051.351292,44880278.5195465,-102110202.043782,331330587.055682,-251452518.956571,871498606.584433,3580553880.91017,-2127922317.25410,-5044072500.15872,-7925129790.41128,-676080084.277153,1120304710.36570,3026856000.56882,-7729801724.55150;-21064188.0040303,6265014.11794567,5225439.55114838,30975819.1876843,11226678.5882625,8992046.54939181,10762915.5292008,17063629.0456309,8798594.66256866,46349578.3089325,13872151.3440565,-5454825.23566891,-16448619.3061468,-15818855.6457121,-144047.855292410,-49148366.1099380,-45193848.1660390,9390016.01221902,248795403.865734,26155197.3292289,-59509202.0271000,193096357.940558,-146544698.334672,507900756.179589,2086714678.93838,-1240134921.77252,-2939642315.91429,-4618699410.99642,-394013676.531348,652904362.567582,1764025975.34322,-4504864466.12046;-17158828.6075737,5103462.56081008,4256626.24579219,25232813.3818767,9145218.14332568,7324893.11898685,8767436.68883922,13899971.9977393,7167212.77628309,37756202.7821603,11281661.0678295,-4444239.03334752,-13399754.5997140,-12903696.8291947,-117215.660535416,-40053322.3664847,-36816395.8224547,7649119.50261748,202669055.735454,21306489.6337413,-48475849.9217197,157295096.514592,-119374682.330439,413731854.416412,1699827897.30252,-1010210903.99260,-2394625511.15743,-3762380835.70617,-320962648.398149,531854490.445043,1436971165.21252,-3669652458.99636;35428047.4103432,-10537183.2444850,-8788712.02479319,-52098507.7665670,-18882250.3859390,-15123803.5278999,-18102244.9642181,-28699470.8349021,-14798431.8923473,-77955869.3115823,-23295681.7568299,9174506.38477901,27683399.9124110,26605914.1033085,239774.289841565,82663347.3396650,76011976.9916819,-15792953.1821838,-418451291.448325,-43988210.6888648,100089945.740832,-324770521.653719,246475939.485439,-854242888.108097,-3509664475.31612,2085792978.82693,4944208286.17040,7768232907.68586,662694683.633720,-1098125894.08666,-2966930270.57698,7576772909.39358;-90049278.1413696,26782895.4870664,22338709.1306226,132421442.351554,47993974.9325798,38440943.1224944,46011385.5296465,72946909.6999257,37613892.4718625,198144003.369470,59205935.7330623,-23319433.1499025,-70321895.0931586,-67623070.5770822,-616251.730099024,-210123972.901769,-193203794.587726,40142494.7208474,1063599497.20601,111815987.197544,-254400660.935868,825486019.880308,-626476840.706707,2171273171.17476,8920695931.38785,-5301573108.36003,-12566962127.8781,-19744921108.7677,-1684407425.46891,2791163471.23878,7541205083.09657,-19258277389.6767;-30352229.1117624,9027508.31537758,7529541.33368430,44634293.9615089,16176960.0287064,12956999.0659957,15508693.0870197,24587664.8445531,12678250.5612263,66786530.1860554,19951993.8319608,-7860138.12658201,-23687955.7043294,-22794160.8300587,-193479.671840329,-70819973.9809757,-65121648.6755354,13531247.4592658,358499268.925934,37697809.7981796,-85745730.4896622,278240271.496397,-211157892.223787,731854509.326869,3006830707.47366,-1786965316.00139,-4235860596.36060,-6655268995.43035,-567752203.824668,940795844.848019,2541860430.06237,-6491239617.62596;500887.877471641,-148976.327623685,-124255.146767563,-736578.081799154,-266960.474121196,-213822.933220811,-255932.627839132,-405758.026386136,-209219.623983408,-1102152.83766499,-329328.783822724,129712.901553224,391161.432511769,376157.425259707,3429.01707960074,1168704.28931173,1074670.56274880,-199487.361166484,-5916185.64546856,-615764.585935326,1417272.76011697,-4591701.54504283,3487403.77112493,-12077547.6742310,-49620681.1393357,29486267.3356438,69894985.4018818,109829535.196935,9368044.45443871,-15525752.4967643,-41944350.2530314,107122650.848384;1919068.62783633,-570778.962080052,-476068.609499618,-2822074.84399482,-1022814.73870527,-819227.135862344,-980563.040672398,-1554594.79580178,-801605.557625576,-4222708.91442701,-1261756.86786750,496964.460883890,1498650.12625016,1441190.37707384,13134.1983733403,4477704.96615390,4094119.43678496,-855487.151904199,-22666961.6967143,-2382937.91923733,5421601.34988002,-17591936.1343133,13351013.0356838,-46271712.3866722,-190109950.787419,112983228.642897,267817861.195514,420789421.852418,35896864.2302355,-59483331.8749405,-160712627.768016,410418828.036142;-2516174.87766254,748373.019138403,624192.777505717,3700146.31894819,1341057.23150553,1074124.51720983,1285659.29817957,2038297.17316361,1051015.48572977,5536579.00781054,1654342.33517798,-651593.937793046,-1964943.48687138,-1889607.88340860,-17219.6444045074,-5870917.12970680,-5398531.05281600,1121672.51175844,29719303.5852684,3097630.01906697,-7109921.21702363,23065891.9514510,-17506808.7376978,60670142.7495648,249263833.078505,-148135570.469316,-351143793.527438,-551716441.185900,-47065226.0506963,77991314.8748538,210715996.848112,-538118570.299571;3221960.64038731,-958291.251775242,-799278.438646713,-4738035.48916598,-1717223.10205037,-1375415.88299108,-1646286.08715199,-2610038.45585132,-1345824.52793495,-7089586.61808464,-2118384.31885376,834365.875457854,2516108.93894455,2419641.56284744,22049.6456512787,7517705.77375549,6912768.76049810,-1436297.39030559,-38032553.0706379,-4000774.58943825,9102456.18550438,-29533075.6615016,22415293.2955152,-77677332.5276838,-319165537.579520,189690115.675418,449645537.518856,706474761.668264,60268184.9798777,-99869045.4175815,-269824176.997241,689067533.514845;105213.435031785,-31293.0926352166,-26100.5106775001,-154721.006051659,-56076.0845611993,-44914.3376855444,-53759.6282429113,-85231.0571153604,-43948.0268878830,-231511.139492601,-69176.0362339945,27246.3115126683,82163.7649150664,79013.6279849203,720.026963185060,245491.389360060,225737.768650947,-46902.2646775375,-1242634.56383525,-130645.710446958,297244.426001191,-943803.729989874,731955.342455217,-2531509.45707263,-10416756.5827878,6194339.26042990,14683209.2906696,23070672.9383265,1968105.41785152,-3261654.28643643,-8811157.09661291,22503813.0885406;-1088815.92253444,323840.945638180,270104.830760034,1601151.92341542,580311.204511514,464802.298612121,556339.048860789,882025.501456587,454802.346950150,2395825.28530669,715877.950449229,-281962.079608041,-850283.382701030,-817683.638077892,-7451.38478556979,-2540502.27667207,-2336088.08656715,485376.338994867,12860333.0130272,1351840.82457657,-3095800.96801523,9981229.11706367,-7572992.36340933,26253604.5526957,107863125.192805,-64104543.7668777,-151954634.642627,-238742420.535362,-20367302.8000686,33748830.3963711,91184505.4128764,-232858227.357643;-5017377.31356986,1492292.84640394,1244671.21931976,7378275.02970715,2674134.54325537,2141857.46318137,2563668.34626052,4064465.48059138,2095776.63349299,11040212.7764207,3298840.30170352,-1299310.72844266,-3918194.47634181,-3767971.46713139,-34336.7400092699,-11706899.3190121,-10764938.8730198,2236665.08237178,59261798.9044914,6230185.63485075,-14174712.0145113,45993735.1708503,-34906123.8359888,121000183.269214,497052547.763412,-295393705.646092,-700207540.893390,-1100149076.28466,-93851959.5529221,155517828.476589,420181762.331959,-1073032070.78258;422122.877178936,-125549.845734297,-104716.897361785,-620750.342599514,-224980.760572847,-180199.131557494,-215686.997553349,-341952.329711457,-176322.248665221,-928837.142031867,-277538.615849505,109313.843518972,329646.220038119,317007.643490107,2888.81746997935,984926.919569904,905677.680966012,-188175.595365814,-4985822.51867212,-524360.284311143,1190906.36851737,-3869626.69586676,2920435.92946162,-10178247.7448895,-41817429.5542787,24845901.8028567,58896675.3488150,92558015.0295975,7893678.21843733,-13084328.4699827,-35345661.2699477,90276851.4027499;3335490.91840892,-992057.986494790,-827442.163186002,-4904986.77375282,-1777731.85643069,-1423880.57874881,-1704295.28364243,-2702006.81612053,-1393246.59934724,-7339398.08822097,-2193028.58416232,863765.839108731,2604767.65116475,2504901.22399388,22826.6527202689,7782603.12958472,7156398.96404309,-1486907.67159258,-39396492.0060508,-4141790.83783706,9422944.07385502,-30576606.9677155,23204352.6515548,-80425550.7207964,-330429081.492401,196347405.381110,465468048.711157,731366219.757199,62388038.1449308,-103387078.566395,-279323580.068554,713340684.131338;-5954016.43548159,1770872.62481970,1477025.23237585,8755644.24519600,3173339.38301261,2541697.33227481,3042251.46461028,4823215.94774172,2487014.16467028,13101188.9731417,3914664.60105461,-1541864.78175188,-4649639.23204675,-4471372.70895227,-40746.7101930285,-13892331.9266463,-12774526.4975900,2654203.80864087,70324685.3934803,7393231.01288443,-16820847.5655548,54580798.4293636,-41422353.2423048,143564126.990247,589850025.966649,-350537522.989570,-830921626.372795,-1305526049.90678,-111372301.213097,184551112.406987,498620981.257454,-1273351976.58628;9688345.40567073,-2881554.97078609,-2403407.97873597,-14247139.9969556,-5163641.78046167,-4135837.03382697,-4950336.18330887,-7848312.57594462,-4046856.85672524,-21318188.3809922,-6369922.42074356,2508914.57850654,7565869.41146369,7275795.03654339,66302.8346836247,22605532.1793716,20786644.9341729,-4318906.99434513,-114431977.622552,-12030227.3146553,27370799.9639782,-88813527.0290140,67402238.9572767,-233605920.778904,-959771689.839275,570392890.097928,1352071499.28388,2124322942.14524,181224116.065075,-300297401.931103,-811353371.538303,2071976506.44989;7448092.75129020,-2215248.09364758,-1847663.84723562,-10952749.4834304,-3969644.07281807,-3179500.37311481,-3805661.49310111,-6033533.85525786,-3111095.23479006,-16388747.2734669,-4896994.38093459,1928773.97558549,5816400.50583350,5593400.52438298,50971.5167886684,17378416.3659974,15980113.5273353,-3320238.74643578,-87971676.0170095,-9248457.32459608,21041802.5816010,-68277025.3527579,51816702.7590911,-179588848.966120,-737842354.183376,438500000.731627,1039447681.15911,1633127943.68458,139318931.761166,-230860777.382802,-623741724.756551,1592876998.90219;-1443401.78108028,429303.601701303,358067.679474647,2122586.09552317,769296.451616816,616170.696915302,737517.477377447,1169267.59690483,602914.135471455,3176054.29970948,949012.136072884,-373786.402106276,-1127188.27915969,-1083972.03772666,-9878.01578450593,-3367847.04107848,-3096863.19105830,643445.069164241,17048454.9595349,1792303.08502399,-4077791.94568794,13231733.9241589,-10041808.4823979,34803389.9449615,142990039.496268,-84979021.7877263,-201436051.178141,-316491596.415058,-26999431.4365823,44748641.1051815,120878223.357962,-308693366.394010;-335172.393957732,99688.6090956034,83146.9123491674,492885.814874285,178638.364462671,143081.025845992,171258.967390215,271515.682458888,140002.718711223,737511.714971768,220370.151313615,-86796.9575826753,-261744.442508629,-251709.196153472,-2293.77482035582,-782047.915968730,-719122.738912034,149414.409912011,3958822.47502883,416190.823287659,-946903.961593986,3072541.39538048,-2331810.36469957,8081696.78610931,33203720.6738535,-19732981.2896750,-46775948.3090907,-73492561.0261803,-6278280.03125257,10389015.5572785,28068136.9171439,-71681416.3407466;11959617.8966753,-3557087.91914614,-2966847.26574128,-17587146.5506692,-6374172.27224817,-5105415.68618115,-6110860.70238336,-9688219.77459842,-4995575.57770034,-26315885.3872733,-7863245.47669296,3097088.14450401,9339562.47643115,8981484.95876016,81846.4378181624,27905025.6659021,25659730.3588642,-5331403.36182228,-141258663.845751,-14850515.1497059,33787431.5018213,-109634394.050605,83203580.0903297,-288371008.583386,-1184774812.54534,704112085.430813,1669042339.28015,2622360667.68070,223709383.269016,-370699407.305229,-1001562001.42976,2557746176.39895;-5878948.41965553,1748545.52891412,1458402.95188911,8645253.41138836,3133330.03861126,2509651.70790252,3003894.87177698,4762405.02207511,2455657.98209840,12936009.6739198,3865308.65529167,-1522425.01479209,-4591016.74734040,-4414997.80880691,-40232.9728999618,-13717177.9194346,-12613465.7968649,2620739.69458191,69438037.7776997,7300016.83817630,-16608772.5997913,53892603.5703897,-40900098.2103928,141753548.584191,582395691.557881,-346117964.313230,-820444841.391031,-1289064892.61774,-109967496.993621,182223651.911051,492320172.215666,-1257294045.78001];
% BB = [3.69008830057986;-1.65543605179195;-1.63648162262607;-1.33063592184483;-3.26856481266132;-3.15848020787483;-1.18836934131473;-2.27292535706182;-2.16792072357065;-2.50218374347295;-0.741865877757183;2.26989966899830;0.822494186820991;-2.62260916022296;-1.93718066679121;2.32703799061246;1.17844134069387;-1.29002911955523;0.0515879655845228;0.0307182396345243;0.00408597385613568;0.00179021559435943;0.00327873327241881;0.00149483919542632;0.000542141164554575;0.00153263021394847;0.000111532120087149;-1.13825722169260e-05;2.95986399093214e-06;4.47746365804479e-07;-4.06839946455041e-06;-1.55244354944008e-06];
% CC = [17360.4410910606,-5163.42711025477,-4306.64069938660,-25529.2956924438,-9252.67372190952,-7410.96154004335,-8870.45373487473,-14063.3062132597,-7251.51892662048,-38199.8306274414,-11414.1949234009,4495.69683170319,13557.1993675232,13037.4182424545,118.807329177856,40506.6080207825,37247.3636865616,-7739.00259876251,-205049.419967651,-21556.8336181641,49045.4396972656,-159144.000366211,120777.341247559,-418595.972778320,-1719805.20764160,1022080.84570313,2422762.26562500,3806588.13037109,324733.910400391,-538103.419250488,-1453855.50000000,3712768.91430664];
% DD = 0;
% C = tf(ss(AA,BB,CC,DD));

%% Model 3


%% Observer test


%% Control evaluation
controlontime = 1e-13;
 
if currenttime < controlontime
    controlsignal = 0;
else
    stoptime = currenttime + dt;
    duration = currenttime:dt:stoptime;
    plantoutput = [plantoutputp plantoutputc]';
    [controlsignalarray,~,~] = lsim(C,plantoutput,duration,lastcontrolinput);
    controlsignal = controlsignalarray(end);
end


 
 
 